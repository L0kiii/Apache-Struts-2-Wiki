    

<!DOCTYPE html>
<html lang="zh-CN">
<head>
                            <title>StrutsCatalogLazyList - Apache Struts 2 Wiki - Apache Software Foundation</title>
    
        

                        
    
                        
    

                
    
    <meta http-equiv="X-UA-Compatible" content="IE=EDGE,chrome=IE7">
<meta charset="UTF-8">
<meta id="confluence-context-path" name="confluence-context-path" content="/confluence">
<meta id="confluence-base-url" name="confluence-base-url" content="https://cwiki.apache.org/confluence">

    <meta id="atlassian-token" name="atlassian-token" content="d63edcb3a3a0acf15ba70ea5453e957f655f448c">


<meta id="confluence-space-key" name="confluence-space-key" content="WW">
<script type="text/javascript">
        var contextPath = '/confluence';
</script>

    

    <meta name="confluence-request-time" content="1595840032000">
        
    
        
            <meta name="ajs-use-keyboard-shortcuts" content="true">
            <meta name="ajs-is-confluence-admin" content="false">
            <meta name="ajs-connection-timeout" content="10000">
            <script type="text/x-template" title="gliffy-webpanel-footer">
        <div class="gliffy-webpanel-footer"><span>This Confluence installation runs a Free Gliffy License - Evaluate the <a href="http://www.gliffy.com/products/confluence-plugin/">Gliffy Confluence Plugin</a> for your Wiki!</span></div>
</script>


            <style>.ia-fixed-sidebar, .ia-splitter-left {width: 285px;}.theme-default .ia-splitter #main {margin-left: 285px;}.ia-fixed-sidebar {visibility: hidden;}</style>
            <meta name="ajs-discovered-plugin-features" content="$discoveredList">
            <meta name="ajs-keyboardshortcut-hash" content="244b3b2851a4a758ccc0304672ffd8c1">
            
    
    
            <meta name="ajs-page-title" content="StrutsCatalogLazyList">
            <meta name="ajs-latest-published-page-title" content="StrutsCatalogLazyList">
            <meta name="ajs-space-name" content="Apache Struts 2 Wiki">
            <meta name="ajs-page-id" content="120724385">
            <meta name="ajs-latest-page-id" content="120724385">
            <meta name="ajs-content-type" content="page">
            <meta name="ajs-parent-page-title" content="Home">
            <meta name="ajs-parent-page-id" content="14153">
            <meta name="ajs-space-key" content="WW">
            <meta name="ajs-max-number-editors" content="12">
            <meta name="ajs-macro-placeholder-timeout" content="5000">
            <meta name="ajs-jira-metadata-count" content="-1">
            <meta name="ajs-from-page-title" content="">
            <meta name="ajs-can-remove-page" content="false">
            <meta name="ajs-can-remove-page-hierarchy" content="false">
            <meta name="ajs-browse-page-tree-mode" content="view">
            <meta name="ajs-shared-drafts" content="true">
            <meta name="ajs-context-path" content="/confluence">
            <meta name="ajs-base-url" content="https://cwiki.apache.org/confluence">
            <meta name="ajs-version-number" content="7.5.0">
            <meta name="ajs-build-number" content="8501">
            <meta name="ajs-remote-user" content="">
            <meta name="ajs-remote-user-key" content="">
            <meta name="ajs-remote-user-has-licensed-access" content="false">
            <meta name="ajs-remote-user-has-browse-users-permission" content="false">
            <meta name="ajs-current-user-fullname" content="">
            <meta name="ajs-current-user-avatar-url" content="">
            <meta name="ajs-current-user-avatar-uri-reference" content="/confluence/images/icons/profilepics/anonymous.svg">
            <meta name="ajs-static-resource-url-prefix" content="/confluence/s/962fig/8501/fded9f91818631c3677be93247bf5ae6723a1c8d/_">
            <meta name="ajs-global-settings-attachment-max-size" content="20971520">
            <meta name="ajs-global-settings-quick-search-enabled" content="true">
            <meta name="ajs-user-locale" content="zh_CN">
            <meta name="ajs-enabled-dark-features" content="site-wide.shared-drafts,site-wide.synchrony,clc.quick.create,confluence.view.edit.transition,cql.search.screen,confluence-inline-comments-resolved,http.session.registrar,frontend.editor.v4,nps.survey.inline.dialog,confluence.efi.onboarding.new.templates,frontend.editor.v4.compatibility,atlassian.cdn.static.assets,pdf-preview,previews.sharing,previews.versions,file-annotations,collaborative-audit-log,confluence.efi.onboarding.rich.space.content,previews.conversion-service,editor.ajax.save,graphql,read.only.mode,previews.trigger-all-file-types,lucene.caching.filter,attachment.extracted.text.extractor,confluence.table.resizable,notification.batch,previews.sharing.pushstate,confluence-inline-comments-rich-editor,site-wide.synchrony.opt-in,file-annotations.likes,gatekeeper-ui-v2,v2.content.name.searcher,mobile.supported.version,pulp,confluence-inline-comments,quick-reload-inline-comments-flags,confluence-inline-comments-dangling-comment">
            <meta name="ajs-atl-token" content="d63edcb3a3a0acf15ba70ea5453e957f655f448c">
            <meta name="ajs-confluence-flavour" content="VANILLA">
            <meta name="ajs-user-date-pattern" content="yyyy-M-d">
            <meta name="ajs-access-mode" content="READ_WRITE">
            <meta name="ajs-render-mode" content="READ_WRITE">
            <meta name="ajs-date.format" content="MMM dd, yyyy">
    
    
    

<link rel="search" type="application/opensearchdescription+xml" href="/confluence/opensearch/osd.action" title="Apache Software Foundation">
    
                    
            <meta name="ajs-create-issue-metadata-show-discovery" content="false">
            

    <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\u0022\u005C/confluence\u0022";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-feature-discovery-plugin:confluence-feature-discovery-plugin-resources.test-mode"]="false";
WRM._unparsedData["com.atlassian.confluence.plugins.synchrony-interop:synchrony-status-banner-loader.synchrony-status"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common-exported.applinks-help-paths"]="{\u0022entries\u0022:{\u0022applinks.docs.root\u0022:\u0022https://confluence.atlassian.com/display/APPLINKS-060/\u0022,\u0022applinks.docs.diagnostics.troubleshoot.sslunmatched\u0022:\u0022SSL+and+application+link+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.oauthsignatureinvalid\u0022:\u0022OAuth+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.oauthtimestamprefused\u0022:\u0022OAuth+troubleshooting+guide\u0022,\u0022applinks.docs.delete.entity.link\u0022:\u0022Create+links+between+projects\u0022,\u0022applinks.docs.adding.application.link\u0022:\u0022Link+Atlassian+applications+to+work+together\u0022,\u0022applinks.docs.administration.guide\u0022:\u0022Application+Links+Documentation\u0022,\u0022applinks.docs.oauth.security\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.troubleshoot.application.links\u0022:\u0022Troubleshoot+application+links\u0022,\u0022applinks.docs.diagnostics.troubleshoot.unknownerror\u0022:\u0022Network+and+connectivity+troubleshooting+guide\u0022,\u0022applinks.docs.configuring.auth.trusted.apps\u0022:\u0022Configuring+Trusted+Applications+authentication+for+an+application+link\u0022,\u0022applinks.docs.diagnostics.troubleshoot.authlevelunsupported\u0022:\u0022OAuth+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.ssluntrusted\u0022:\u0022SSL+and+application+link+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.unknownhost\u0022:\u0022Network+and+connectivity+troubleshooting+guide\u0022,\u0022applinks.docs.delete.application.link\u0022:\u0022Link+Atlassian+applications+to+work+together\u0022,\u0022applinks.docs.link.applications\u0022:\u0022Link+Atlassian+applications+to+work+together\u0022,\u0022applinks.docs.diagnostics.troubleshoot.oauthproblem\u0022:\u0022OAuth+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.migration\u0022:\u0022Update+application+links+to+use+OAuth\u0022,\u0022applinks.docs.relocate.application.link\u0022:\u0022Link+Atlassian+applications+to+work+together\u0022,\u0022applinks.docs.administering.entity.links\u0022:\u0022Create+links+between+projects\u0022,\u0022applinks.docs.upgrade.application.link\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.diagnostics.troubleshoot.connectionrefused\u0022:\u0022Network+and+connectivity+troubleshooting+guide\u0022,\u0022applinks.docs.configuring.auth.oauth\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.insufficient.remote.permission\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.configuring.application.link.auth\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.diagnostics\u0022:\u0022Application+links+diagnostics\u0022,\u0022applinks.docs.configured.authentication.types\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.adding.entity.link\u0022:\u0022Create+links+between+projects\u0022,\u0022applinks.docs.diagnostics.troubleshoot.unexpectedresponse\u0022:\u0022Network+and+connectivity+troubleshooting+guide\u0022,\u0022applinks.docs.configuring.auth.basic\u0022:\u0022Configuring+Basic+HTTP+Authentication+for+an+Application+Link\u0022,\u0022applinks.docs.diagnostics.troubleshoot.authlevelmismatch\u0022:\u0022OAuth+troubleshooting+guide\u0022}}";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common-exported.applinks-types"]="{\u0022crowd\u0022:\u0022\u4eba\u7fa4\u0022,\u0022confluence\u0022:\u0022Confluence\u0022,\u0022fecru\u0022:\u0022Fisheye / Crucible\u0022,\u0022stash\u0022:\u0022\u6682\u5b58\u0022,\u0022jira\u0022:\u0022Jira\u0022,\u0022refapp\u0022:\u0022\u76f8\u5173\u5e94\u7528\u7a0b\u5e8f\u0022,\u0022bamboo\u0022:\u0022\u7af9\u0022,\u0022generic\u0022:\u0022\u901a\u7528\u5e94\u7528\u7a0b\u5e8f\u0022}";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common-exported.entity-types"]="{\u0022singular\u0022:{\u0022refapp.charlie\u0022:\u0022Charlie\u0022,\u0022fecru.project\u0022:\u0022Crucible\u9879\u76ee\u0022,\u0022fecru.repository\u0022:\u0022FishEye \u4ed3\u5e93\u0022,\u0022stash.project\u0022:\u0022Stash \u9879\u76ee\u0022,\u0022generic.entity\u0022:\u0022\u901a\u7528\u9879\u76ee\u0022,\u0022confluence.space\u0022:\u0022Confluence\u7a7a\u95f4\u0022,\u0022bamboo.project\u0022:\u0022Bamboo\u9879\u76ee\u0022,\u0022jira.project\u0022:\u0022Jira \u9879\u76ee\u0022},\u0022plural\u0022:{\u0022refapp.charlie\u0022:\u0022\u67e5\u7406\u65af\u0022,\u0022fecru.project\u0022:\u0022Crucible\u9879\u76ee\u0022,\u0022fecru.repository\u0022:\u0022FishEye \u4ed3\u5e93\u96c6\u0022,\u0022stash.project\u0022:\u0022Stash\u9879\u76ee\u0022,\u0022generic.entity\u0022:\u0022\u901a\u7528\u9879\u76ee\u0022,\u0022confluence.space\u0022:\u0022Confluence\u7a7a\u95f4\u0022,\u0022bamboo.project\u0022:\u0022Bamboo\u9879\u76ee\u0022,\u0022jira.project\u0022:\u0022Jira \u9879\u76ee\u0022}}";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common-exported.authentication-types"]="{\u0022com.atlassian.applinks.api.auth.types.BasicAuthenticationProvider\u0022:\u0022\u57fa\u672c\u8bbf\u95ee\u0022,\u0022com.atlassian.applinks.api.auth.types.TrustedAppsAuthenticationProvider\u0022:\u0022\u4fe1\u4efb\u7684\u5e94\u7528\u65e0\u6548\u0022,\u0022com.atlassian.applinks.api.auth.types.CorsAuthenticationProvider\u0022:\u0022\u6b4c\u73e5\u0022,\u0022com.atlassian.applinks.api.auth.types.OAuthAuthenticationProvider\u0022:\u0022Oauth\u0022,\u0022com.atlassian.applinks.api.auth.types.TwoLeggedOAuthAuthenticationProvider\u0022:\u0022Oauth\u0022,\u0022com.atlassian.applinks.api.auth.types.TwoLeggedOAuthWithImpersonationAuthenticationProvider\u0022:\u0022Oauth\u0022}";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-license-banner:confluence-license-banner-resources.license-details"]="{\u0022daysBeforeLicenseExpiry\u0022:0,\u0022daysBeforeMaintenanceExpiry\u0022:0,\u0022showLicenseExpiryBanner\u0022:false,\u0022showMaintenanceExpiryBanner\u0022:false,\u0022renewUrl\u0022:null,\u0022salesUrl\u0022:null}";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-search-ui-plugin:confluence-search-ui-plugin-resources.i18n-data"]="{\u0022search.ui.recent.link.text\u0022:\u0022\u67e5\u770b\u66f4\u591a\u6700\u8fd1\u8bbf\u95ee\u0022,\u0022search.ui.filter.space.category.input.label\u0022:\u0022\u67e5\u627e\u7a7a\u95f4\u7c7b\u522b\u2026\u2026\u0022,\u0022search.ui.filter.clear.selected\u0022:\u0022\u6e05\u9664\u6240\u9009\u9879\u76ee\u0022,\u0022search.ui.search.results.empty\u0022:\u0022\u6211\u4eec\u627e\u4e0d\u5230\u4efb\u4f55\u5339\u914d\u201c{0}\u201d\u7684\u5185\u5bb9\u3002\u0022,\u0022search.ui.content.name.search.items.panel.load.all.top.items.button.text\u0022:\u0022\u663e\u793a\u66f4\u591a\u5e94\u7528\u7ed3\u679c......\u0022,\u0022search.ui.filter.space.archive.label\u0022:\u0022\u641c\u7d22\u5df2\u7ecf\u5f52\u6863\u7684\u7a7a\u95f4\u0022,\u0022search.ui.filter.label\u0022:\u0022\u7b5b\u9009\u5668\u0022,\u0022search.ui.filter.contributor.button.text\u0022:\u0022\u8d21\u732e\u8005\u0022,\u0022search.ui.filter.date.all.text\u0022:\u0022\u968f\u65f6\u0022,\u0022search.ui.filter.space.current.label\u0022:\u0022\u5f53\u524d\u0022,\u0022search.ui.clear.input.button.text\u0022:\u0022\u6e05\u9664\u6587\u672c\u0022,\u0022help.search.ui.link.title\u0022:\u0022\u641c\u7d22\u6280\u5de7\u0022,\u0022search.ui.search.results.clear.button\u0022:\u0022\u6e05\u7a7a\u7b5b\u9009\u5668\u3002\u0022,\u0022search.ui.filter.date.hour.text\u0022:\u0022\u8fc7\u53bb\u4e00\u5929\u0022,\u0022search.ui.filters.heading\u0022:\u0022\u7b5b\u9009\u65b9\u5f0f\u0022,\u0022search.ui.filter.label.input.label\u0022:\u0022\u67e5\u627e\u6807\u7b7e\u2026\u2026\u0022,\u0022search.ui.filter.date.month.text\u0022:\u0022\u8fc7\u53bb\u4e00\u4e2a\u6708\u0022,\u0022search.ui.recent.items.anonymous\u0022:\u0022\u5f00\u59cb\u63a2\u7d22\u3002 \u60a8\u7684\u641c\u7d22\u7ed3\u679c\u5c06\u663e\u793a\u5728\u6b64\u5904\u3002\u0022,\u0022search.ui.input.label\u0022:\u0022\u641c\u7d22\u0022,\u0022search.ui.search.result\u0022:\u0022{0,choice,1#{0}\u4e2a\u641c\u7d22\u7ed3\u679c|1\u005Cu003c{0}\u4e2a\u641c\u7d22\u7ed3\u679c}\u0022,\u0022search.ui.infinite.scroll.button.text\u0022:\u0022\u66f4\u591a\u7ed3\u679c\u0022,\u0022search.ui.filter.date.button.text\u0022:\u0022\u65e5\u671f\u0022,\u0022search.ui.filter.date.week.text\u0022:\u0022\u8fc7\u53bb\u4e00\u5468\u0022,\u0022search.ui.filter.label.button.text\u0022:\u0022\u6807\u7b7e\u0022,\u0022search.ui.input.alert\u0022:\u0022\u6309\u56de\u8f66\u952e(Enter)\u641c\u7d22\u0022,\u0022search.ui.filter.no.result.text\u0022:\u0022\u6211\u4eec\u627e\u4e0d\u5230\u4efb\u4f55\u7b26\u5408\u60a8\u641c\u7d22\u6761\u4ef6\u7684\u5185\u5bb9\u0022,\u0022search.ui.result.subtitle.calendar\u0022:\u0022\u56e2\u961f\u65e5\u7a0b\u8868\u0022,\u0022search.ui.filter.date.heading\u0022:\u0022\u4e0a\u6b21\u4fee\u6539\u0022,\u0022search.ui.result.subtitle.user\u0022:\u0022\u7528\u6237\u8d44\u6599\u0022,\u0022search.ui.filter.contributor.input.label\u0022:\u0022\u67e5\u627e\u4eba\u5458\u2026\u2026\u0022,\u0022search.ui.filter.content.type.button.text\u0022:\u0022\u7c7b\u578b\u0022,\u0022search.ui.filter.space.input.label\u0022:\u0022\u67e5\u627e\u7a7a\u95f4\u0022,\u0022search.ui.filter.date.year.text\u0022:\u0022\u8fc7\u53bb\u4e00\u5e74\u0022,\u0022search.ui.filter.space.button.text\u0022:\u0022\u7a7a\u95f4\u0022,\u0022search.ui.advanced.search.link.text\u0022:\u0022\u9ad8\u7ea7\u641c\u7d22\u0022,\u0022search.ui.generic.error\u0022:\u0022\u51fa\u9519\u4e86\u3002\u5237\u65b0\u9875\u9762\uff0c\u6216\u8005\u5982\u679c\u6301\u7eed\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\uff0c\u8bf7\u8054\u7cfb\u60a8\u7684\u7ba1\u7406\u5458\u3002\u0022,\u0022search.ui.recent.spaces\u0022:\u0022\u6700\u8fd1\u7a7a\u95f4\u0022,\u0022search.ui.search.results.clear.line2\u0022:\u0022\u8bf7\u5c1d\u8bd5\u4e0d\u540c\u7684\u641c\u7d22\u5173\u952e\u5b57\u6216\u8005\u0022,\u0022search.ui.filter.space.category.button.text\u0022:\u0022\u7a7a\u95f4\u7c7b\u522b\u0022,\u0022search.ui.search.results.clear.line1\u0022:\u0022\u627e\u4e0d\u5230\u5339\u914d\u7684\u641c\u7d22\u7ed3\u679c\u0022,\u0022search.ui.content.name.search.items.panel.load.all.top.items.admin.button.text\u0022:\u0022\u663e\u793a\u66f4\u591a\u8bbe\u7f6e\u548c\u5e94\u7528\u7ed3\u679c...\u0022,\u0022search.ui.recent.pages\u0022:\u0022\u6700\u8fd1\u8bbf\u95ee\u0022,\u0022search.ui.search.result.anonymous\u0022:\u0022{0,choice,1#{0}\u4e2a\u641c\u7d22\u7ed3\u679c| 1 \u005Cu003c{0}\u4e2a\u641c\u7d22\u7ed3\u679c}\u3002 \u60a8\u6709\u5e10\u6237\u5417\uff1f{1}\u767b\u5f55{2}\u641c\u7d22\u66f4\u591a\u7ed3\u679c\u3002\u0022,\u0022search.ui.recent.items.empty\u0022:\u0022\u5f00\u59cb\u63a2\u7d22\u3002 \u60a8\u6700\u8fd1\u8bbf\u95ee\u8fc7\u7684\u9875\u9762\u548c\u7a7a\u95f4\u5c06\u663e\u793a\u5728\u6b64\u5904\u3002\u0022,\u0022search.ui.result.subtitle.space\u0022:\u0022\u7a7a\u95f4\u0022,\u0022search.ui.filter.space.init.heading\u0022:\u0022\u6700\u8fd1\u7a7a\u95f4\u0022}";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script>
<link type="text/css" rel="stylesheet" href="static/css/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all">
<link type="text/css" rel="stylesheet" href="static/css/batch-true_true_true.css" data-wrm-key="atl.confluence.plugins.pagetree-desktop,main,viewcontent,atl.general,page,atl.comments,-_super" data-wrm-batch-type="context" media="all">
<script type="text/javascript" src="static/js/batch-zh-CN.js" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered=""></script>
<script type="text/javascript" src="static/js/batch-true_true_true_zh-CN.js" data-wrm-key="atl.confluence.plugins.pagetree-desktop,main,viewcontent,atl.general,page,atl.comments,-_super" data-wrm-batch-type="context" data-initially-rendered=""></script>

    

        
    

        
        <meta name="ajs-site-title" content="Apache Software Foundation">
            
    

    
                <link rel="canonical" href="">
        <link rel="shortlink" href="https://cwiki.apache.org/confluence/x/oRsyBw">
    <meta name="wikilink" content="[WW:StrutsCatalogLazyList]">
    <meta name="page-version" content="38">
    <meta name="ajs-page-version" content="38">

</head>

    
<body id="com-atlassian-confluence" class="theme-default  aui-layout aui-theme-default">

        
            <div id='stp-licenseStatus-banner'></div>
    <ul id="assistive-skip-links" class="assistive">
    <li><a href="#title-heading">转至内容</a></li>
    <li><a href="#breadcrumbs">转至导航栏</a></li>
    <li><a href="#header-menu-bar">转至主菜单</a></li>
    <li><a href="#navigation">转至动作菜单</a></li>
    <li><a href="#quick-search-query">转至快速搜索</a></li>
</ul>
<div id="page">
<div id="full-height-container">
    <div id="header-precursor">
        <div class="cell">
            
                            </div>
    </div>
        





<header id="header" role="banner">
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation"><div class="aui-header-inner"><div class="aui-header-before"><a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger="" href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">已链接应用程序</span></a><div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}"><div role="application"><div class="app-switcher-loading">正在上传和乱码；</div></div></div></div><div class="aui-header-primary"><h1 id="logo" class="aui-header-logo aui-header-logo-confluence"><a href="index.html"><span class="aui-header-logo-device">Apache Software Foundation</span></a></h1><ul class="aui-nav">
                            <li>
            
        
        
<a id="space-directory-link" href="view.html" class=" aui-nav-imagelink" title="空间">
            <span>空间</span>
    </a>
        </li>
                                <li class="aui-buttons">
            </li>
</ul>
</div><div class="aui-header-secondary"><ul class="aui-nav">
                        <li>
        <div id="search-ui" class="aui-quicksearch dont-default-focus header-quicksearch"><input id="quick-search-query" aria-label="搜索" placeholder="搜索" type="text"><div id="quick-search-alert" role="alert">按回车键(Enter)搜索</div><aui-spinner size="small"></aui-spinner></div>
    </li>
        <li>
            
        <a id="help-menu-link" class="aui-nav-link aui-dropdown2-trigger aui-dropdown2-trigger-arrowless" href="#" aria-haspopup="true" aria-owns="help-menu-link-content" title="帮助">
        <span class="aui-icon aui-icon-small aui-iconfont-question-filled">帮助</span>
    </a>
    <nav id="help-menu-link-content" class="aui-dropdown2 aui-style-default" aria-hidden="true">
                    <div class="aui-dropdown2-section">
                                <ul id="help-menu-link-leading" class="aui-list-truncate section-leading first">
                                            <li>
        
            
<a id="confluence-help-link" href="javascript:;" class="    " title="访问Confluence文档首页" target="_blank">
        在线帮助
</a>
</li>
                                            <li>
    
            
<a id="keyboard-shortcuts-link" href="confluence.html" class="    " title="查看可用的键盘快捷方式">
        快捷键
</a>
</li>
                                            <li>
    
            
<a id="feed-builder-link" href="configurerssfeed.html" class="    " title="创建个性化的 RSS源。">
        RSS源建立器
</a>
</li>
                                            <li>
    
            
<a id="whats-new-menu-link" href="javascript:;" class="    " title="">
        新功能
</a>
</li>
                                            <li>
    
            
<a id="gadget-directory-link" href="confluence.html" class="   user-item administration-link " title="浏览小工具">
        可用的小工具
</a>
</li>
                                            <li>
    
            
<a id="confluence-about-link" href="aboutconfluencepage.html" class="    " title="获取关于Confluence的更多信息">
        关于Confluence
</a>
</li>
                                    </ul>
            </div>
            </nav>
    
    </li>
        <li>
                
    
    </li>
        <li>
            
    </li>
        <li>
                                            <li>
        
            
<a id="login-link" href="javascript:;" class="   user-item login-link " title="">
        登录
</a>
</li>
                        <li>
    
            
<a id="signup-link" href="signup.html" class="   user-item signup-link " title="">
        注册
</a>
</li>
                        
    
    </ul>
</div></div><!-- .aui-header-inner--></nav><!-- .aui-header -->
    <br class="clear">
</header>
    

    
    	<div class="ia-splitter">
    		<div class="ia-splitter-left">
    			<div class="ia-fixed-sidebar">
                                            
                            <div class="acs-side-bar ia-scrollable-section"><div class="acs-side-bar-space-info tipsy-enabled" data-configure-tooltip="编辑空间详情"><div class="avatar"><div class="space-logo" data-key="WW" data-name="Apache Struts 2 Wiki" data-entity-type="confluence.space"><div class="avatar-img-container"><div class="avatar-img-wrapper"><a href="home.html" title="Apache Struts 2 Wiki"><img class="avatar-img" src="static/picture/default-space-logo.svg" alt="Apache Struts 2 Wiki"></a></div></div></div></div><div class="space-information-container"><div class="name"><a href="home.html" title="Apache Struts 2 Wiki">Apache Struts 2 Wiki</a></div><div class="flyout-handle icon aui-icon aui-icon-small aui-iconfont-edit"></div></div></div><div class="acs-side-bar-content"><div class="acs-nav-wrapper"><div class="acs-nav" data-has-create-permission="false" data-quick-links-state="null" data-page-tree-state="null" data-nav-type="pages"><div class="acs-nav-sections"><div class="quick-links-wrapper"></div></div></div></div><div class="ia-secondary-container tipsy-enabled" data-tree-type="pages"><div class="ia-secondary-header"><h5 class="ia-secondary-header-title pages"><span class="label">子页面</span></h5></div><div class="ia-secondary-parent-content"><ul class="parent ia-secondary-header-title wiki"><li class="parent-item"><a class="parent-item-link" href="home.html" title="Home"><span class="icon"></span><span class="label">Home</span></a></li></ul></div><div class="ia-secondary-current-content"><ul class="ia-secondary-currentPage-title wiki current-item"><li><span class="icon"></span><span class="label">StrutsCatalogLazyList</span></li></ul></div><div class="ia-secondary-content"><div class="contextual-nav-child-pages"></div></div></div></div><div class="hidden"><a href="pages-ww.html" id="space-pages-link"></a><script type="text/x-template" title="logo-config-content"><h2>空间详情</h2><div class="personal-space-logo-hint">您的个人头像被作为您的个人空间的logo使用。<a href="/confluence/users/profile/editmyprofilepicture.action" target="_blank">更改您的个人头像</a>.</div></script></div></div><div class="space-tools-section"><div id="space-tools-menu-additional-items" class="hidden"><div data-label="浏览页面" data-class="" data-href="/confluence/pages/reorderpages.action?key=WW">浏览页面</div></div><button id="space-tools-menu-trigger" class=" aui-dropdown2-trigger aui-button aui-button-subtle tipsy-enabled aui-dropdown2-trigger-arrowless " aria-controls="space-tools-menu" aria-haspopup="true" role="button" data-aui-trigger=""><span class="aui-icon aui-icon-small aui-iconfont-configure">设置</span><span class="aui-button-label">空间管理</span><span class="aui-icon "></span></button><div id="space-tools-menu" class="aui-dropdown2 aui-style-default space-tools-dropdown" role="menu" aria-hidden="true" data-aui-alignment="top left"><div role="application"></div></div><a class="expand-collapse-trigger aui-icon aui-icon-small aui-iconfont-chevron-double-left"></a></div>
                    
                        			</div>
    		</div>
        <!-- \#header -->

            
    
        <div id="main" class=" aui-page-panel">
                        <div id="main-header">
                        
    <div id="navigation" class="content-navigation view">
                    <ul class="ajs-menu-bar">
                                            
        <li class="normal ajs-menu-item">
        <a id="action-menu-link" class="action aui-dropdown2-trigger-arrowless aui-button aui-button-subtle ajs-menu-title aui-dropdown2-trigger" href="#" aria-haspopup="true" aria-label="更多选项" aria-owns="action-menu" data-container="#navigation">
            <span>
                                    <span class="aui-icon aui-icon-small aui-iconfont-more" aria-label="更多选项"></span>
                                
            </span>
        </a>         <div id="action-menu" class="aui-dropdown2 aui-style-default" aria-hidden="true">
                            <div class="aui-dropdown2-section">
                    <ul id="action-menu-primary" class="section-primary first">
                                                    <li>

    
        
    
                                                        
    
    
            <a id="view-attachments-link" href="javascript:;" rel="nofollow" class="action-view-attachments" accesskey="t" title="查看附件">
                        <span>
                                <u>t</u>附件(0)
            </span>        </a>
    </li>
                                                <li>

    
        
    
                                                        
    
    
            <a id="action-view-history-link" href="javascript:;" rel="nofollow" class="action-view-history" title="">
                        <span>
                                页面历史
            </span>        </a>
    </li>
                                                <li>

    
        
    
                                                        
    
    
            <a id="who-can-view-button-ak-button" href="confluence.html" rel="nofollow" class="who-can-view-link" title="">
                        <span>
                                可以查看的人
            </span>        </a>
    </li>
                                        </ul>
                </div>
                            <div class="aui-dropdown2-section">
                    <ul id="action-menu-secondary" class="section-secondary">
                                                    <li>

    
        
    
                                                        
    
    
            <a id="view-resolved-comments" href="confluence.html" rel="nofollow" class="" title="">
                        <span>
                                已解决评论
            </span>        </a>
    </li>
                                                <li>

    
        
    
                                                        
    
    
            <a id="view-page-info-link" href="javascript:;" rel="nofollow" class="action-view-info" title="">
                        <span>
                                页面信息
            </span>        </a>
    </li>
                                                <li>

    
        
    
                                                        
    
    
            <a id="view-in-hierarchy-link" href="javascript:;" rel="nofollow" class="" title="">
                        <span>
                                以层级方式查看
            </span>        </a>
    </li>
                                                <li>

    
        
    
                                                        
    
    
            <a id="action-view-source-link" href="javascript:;" rel="nofollow" class="action-view-source popup-link" title="">
                        <span>
                                查看页面源代码
            </span>        </a>
    </li>
                                                <li>

    
        
    
                                                        
    
    
            <a id="delete-all-comments-link-link" href="javascript:;" rel="nofollow" class="" title="">
                        <span>
                                Delete comments
            </span>        </a>
    </li>
                                                <li>

    
        
    
                                                        
    
    
            <a id="action-export-pdf-link" href="javascript:;" rel="nofollow" class="" title="">
                        <span>
                                导出为PDF
            </span>        </a>
    </li>
                                                <li>

    
        
    
                                                        
    
    
            <a id="com-k15t-confluence-scroll-epub-launcher" href="javascript:;" rel="nofollow" class="" title="">
                        <span>
                                Export to EPUB
            </span>        </a>
    </li>
                                                <li>

    
        
    
                                                        
    
    
            <a id="action-export-word-link" href="javascript:;" rel="nofollow" class="action-export-word" title="">
                        <span>
                                导出为Word
            </span>        </a>
    </li>
                                        </ul>
                </div>
                    </div>
    </li>
            </ul>
    </div>

            
            <div id="title-heading" class="pagetitle with-breadcrumbs">
                
                                    <div id="breadcrumb-section">
                        
    
    
    <ol id="breadcrumbs">
                                        
                        
        <li class="first">
                        
                            <span class=""><a href="pages-ww.html">页面</a></span>
                                                                                    
                        
        <li>
                        
                            <span class=""><a href="home.html">Home</a></span>
                                                                    </li></ol>


                    </div>
                
                
        <a href="#page-banner-end" class="assistive">跳到banner的尾部</a>
<div id="page-banner-start" class="assistive"></div>

                    
            <div id="page-metadata-banner"><ul class="banner"><li id="system-content-items" class="noprint"><a href="" title="未限制" id="content-metadata-page-restrictions-hidden" class="hidden"></a></li><li class="page-metadata-item noprinthas-button" id="content-metadata-jira-wrapper"><a href="" title="" id="content-metadata-jira" class="aui-button aui-button-subtle content-metadata-jira tipsy-disabled hidden"><span>JIRA 链接</span></a></li></ul></div>
            

<a href="#page-banner-start" class="assistive">回到标题开始</a>
<div id="page-banner-end" class="assistive"></div>
    

                <h1 id="title-text" class="with-breadcrumbs">
                                                <a href="">StrutsCatalogLazyList</a>
                                    </h1>
            </div>
        </div><!-- \#main-header -->
        
        

        <div id="sidebar-container">
                                                </div><!-- \#sidebar-container -->

        
    

        




            
    

                                
    

    
    
        
    
    
                    
    

    

    
            
        

    
    

    
            
        



    
<div id="content" class="page view">
    


<div id="action-messages">
                        </div>



            <script type="text/x-template" title="searchResultsGrid">
    <table class="aui">
        <thead>
            <tr class="header">
                <th class="search-result-title">页面标题</th>
                <th class="search-result-space">空间</th>
                <th class="search-result-date">更新于</th>
            </tr>
        </thead>
    </table>
</script>
<script type="text/x-template" title="searchResultsGridCount">
    <p class="search-result-count">{0}</p>
</script>
<script type="text/x-template" title="searchResultsGridRow">
    <tr class="search-result">
        <td class="search-result-title"><a href="{1}" class="content-type-{2}"><span>{0}</span></a></td>
        <td class="search-result-space"><a class="space" href="/confluence/display/{4}/" title="{3}">{3}</a></td>
        <td class="search-result-date"><span class="date" title="{6}">{5}</span></td>
    </tr>
</script>
        
    
            

        
                            
    

                    

        
        <a href="#page-metadata-end" class="assistive">转至元数据结尾</a>
<div id="page-metadata-start" class="assistive"></div>

    <div class="page-metadata">
        <ul>
            <li class="page-metadata-modification-info">
                
        
    
        
    
        
            
            由<span class='author'>     <a href="javascript:;" class="url fn">ASF Infrabot</a></span>创建, 最后修改于<a class='last-modified' title='查看变更' href='javascript:;'>七月 01, 2019</a>
                </li>
        </ul>
    </div>


<a href="#page-metadata-start" class="assistive">转至元数据起始</a>
<div id="page-metadata-end" class="assistive"></div>

        
                                            
        <div id="main-content" class="wiki-content">
                           
        <p>There are two frequent issues the confront people when dealing with populating a collection of beans in an <a href="actionform.html">ActionForm</a>.</p>

<ul>
	<li>How can I generate the appropriate html using the struts taglibs?</li>
	<li>I have a request scoped <a href="actionform.html">ActionForm</a> and am getting an &quot;index out of range&quot; error when I submit the form - what do I do?
<br class="atl-forced-newline">
<br class="atl-forced-newline"></li>
</ul>


<p>More info on indexed properties available in the <a href="javascript:;" class="external-link" rel="nofollow">FAQs</a></p>


<p>The <em>Indexed Properies</em> section below deals with generating the html and the <em>Lazy List</em> section shows possible solutions for avoiding the &quot;index out of range&quot; error.</p>

<h2 id="StrutsCatalogLazyList-IndexedProperties">Indexed Properties</h2>

<p>Struts html tags have an <em>indexed</em> attribute which will generate the appropriate html to populate a collection of beans when the form is submitted. The <em>trick</em> is to name the <strong>id</strong> attribute to the same as the indexed property.</p>

<p>For example the following jsp...</p>

<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>   &lt;logic:iterate name=&quot;skillsForm&quot; property=&quot;skills&quot; id=&quot;skills&quot;&gt;
       
       &lt;html:text name=&quot;skills&quot; property=&quot;skillId&quot; indexed=&quot;true&quot;/&gt;

   &lt;/logic:iterate&gt;
</pre>
</div></div>

<p>...will generate the following html</p>

<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>    &lt;input type=&quot;text&quot; name=&quot;skills[0].skillId value=&quot;...&quot;/&gt;
    &lt;input type=&quot;text&quot; name=&quot;skills[1].skillId value=&quot;...&quot;/&gt;
    ....
    &lt;input type=&quot;text&quot; name=&quot;skills[n].skillId value=&quot;...&quot;/&gt;
</pre>
</div></div>

<p>When the form is submitted <a class="unresolved" href="#">BeanUtils</a> will first call the getSkills(index) method to retrieve the indexed bean followed by setSkillId(..) on the retrieved bean.</p>


<h3 id="StrutsCatalogLazyList-Usingnestedtags">Using nested tags</h3>

<p>An easy-to-use alternative to the html iterate tag and indexed attribute are the nested tags.  The nested tag equivalent of the example above would be:</p>

<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>   &lt;nested:iterate property=&quot;skills&quot;&gt;
       &lt;nested:text property=&quot;skillId&quot;/&gt;
   &lt;/nested:iterate&gt;
</pre>
</div></div>

<p>The generated html would be the same.</p>

<p><strong>N.B.</strong> More info on using <strong><em>nested</em></strong> tags is available in the<a href="javascript:;" class="external-link" rel="nofollow">JavaDocs</a> and tutorials available at <a href="javascript:;" class="external-link" rel="nofollow">www.keyboardmonkey.com</a>.</p>

<h2 id="StrutsCatalogLazyList-LazyListBehaviour">Lazy List Behaviour</h2>

<p>A common problem with indexed properties, is that people then get &quot;index out of range&quot; errors with <a href="actionforms.html">ActionForms</a> that are in Request scope. The indexed property (List or Array) needs to be able to automatically <em>grow</em> during the <a href="actionform.html">ActionForm</a> population process. The key to achieving this is in the getXXXX(index) method.</p>

<p>The following sections show three examples of how to achieve lazy list processing.</p>

<h3 id="StrutsCatalogLazyList-IndexedPropertiesIssue"><a class="unresolved" href="#">BeanUtils</a> Indexed Properties Issue</h3>

<p>There is an issue in <a href="javascript:;" class="external-link" rel="nofollow">Commons BeanUtils</a> with indexed properties if you use java.util.List rather than Arrays. Full details about the issue are in <a href="javascript:;" class="external-link" rel="nofollow">Bug 28358</a>.</p>

<p>If you define the following types of getter/setter methods for your indexed property, in JDK 1.3 you shouldn't have any problem, but in JDK 1.4 the getter/setter which use the java.util.List are ignored by Bean Utils.</p>

<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>  public SkillBean getSkills(int index)
  public List getSkills()
  public void setSkills(int index, SkillBean skill)
  public void setSkills(List skills)
</pre>
</div></div>


<p>The solution is either to use <a class="unresolved" href="#">DynaBeans</a> which don't have any issues or use method signatures with Arrays rather than java.util.List. For example the following should work...</p>

<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>  public SkillBean getSkills(int index)
  public SkillBean[] getSkills()
  public void setSkills(int index, SkillBean skill)
  public void setSkills(SkillBean[] skills)
</pre>
</div></div>

<h3 id="StrutsCatalogLazyList-HandCrankinglazyListinthe">Hand Cranking lazy List in the <a href="actionform.html">ActionForm</a></h3>

<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>
  public class SkillActionForm extends ActionForm {

      protected List skills = new ArrayList();

      public List getSkills() {
          return skills;
      }

      // non-bean version so as not to confuse struts.
      public void populateSkills(List skills) {
          this.skills.addAll(skills);
       }

      public void setSkills(SkillBean skill) {
          this.skills.add(skill);
      }

      public SkillBean getSkills(int index) {

          // automatically grow List size
          while (index &gt;= skills.size()) {
              skills.add(new SkillBean());
          }

          return (SkillBean)skills.get(index);

      }

  }

</pre>
</div></div>

<h3 id="StrutsCatalogLazyList-UsingCommonsCollectionsforlazyLists">Using Commons Collections for lazy Lists</h3>

<p>Commons collections have a lazy list decorator which automatically grows the list when the get(int) method is called. In the example below the <a href="actionform.html">ActionForm</a> implements the Factory interface, providing the create() method to populate an entry in the List.</p>


<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>
  import org.apache.commons.collections.Factory;
  import org.apache.commons.collections.list.LazyList;

  public class SkillActionForm extends ActionForm, implements Factory {

      protected List skills = LazyList.decorate(new ArrayList(), this);

      public List getSkills() {
          return skills;
      }

      public void setSkills(List skills) {
          this.skills = skills;
      }

      public SkillBean getSkills(int index) {
          return (SkillBean)skills.get(index);
      }

      // 'Factory' method for LazyList
      public Object create() {
          return new SkillBean();
      }

  }

</pre>
</div></div>


<p>The syntax in Commons-Collections 2.1.1 is;</p>

<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>
  import org.apache.commons.collections.Factory;
  import org.apache.commons.collections.ListUtils;

  public class SkillActionForm extends ActionForm, implements Factory {

      protected List skills = ListUtils.lazyList(new ArrayList(), this);

      public List getSkills() {
          return skills;
      }

      public void setSkills(final List newSkills) {
          skills = ListUtils.lazyList(newSkills, this);
      }

      // 'Factory' method for LazyList
      public Object create() {
          return new SkillBean();
      }

  }

</pre>
</div></div>


<p>An easier/cleaner way? ( Rick Reumann )</p>

<p>Someone feel free to edit this, but doesn't that solution above tie your <a href="actionform.html">ActionForm</a> to just one List? What if your form has several lists that need to grow? </p>

<p>Someone gave me this solution and it works great. Since reset is always called it makes sure you have your <a href="lazylist.html">LazyList</a> initialized and then it just grows as needed. You can set this up for other Lists you need in your form as well.</p>

<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>
  import org.apache.commons.collections.Factory;
  import org.apache.commons.collections.ListUtils;
  import java.util.List;
  import java.util.ArrayList;

  public class SkillActionForm extends ActionForm  {

      protected List skills;

      public List getSkills() {
          return skills;
      }

      public void setSkills(final List skills) {
          this.skills =  skills;
      }

      public void reset(ActionMapping actionMapping, HttpServletRequest httpServletRequest) {
        skills = ListUtils.lazyList(new ArrayList(),
        new Factory() {
            public Object create() {
                return new Skills();
            }
        });
    }

  }

</pre>
</div></div>



<h3 id="StrutsCatalogLazyList-/"><a class="unresolved" href="#">LazyDynaBean</a> / <a class="unresolved" href="#">LazyValidatorForm</a></h3>

<p><strong>N.B.</strong> Solutions here require <strong>Struts 1.2.4</strong> and <strong>Bean Utils 1.7.0</strong></p>

<p><a href="javascript:;" class="external-link" rel="nofollow">LazyDynaBean</a> in <a href="javascript:;" class="external-link" rel="nofollow">Commons BeanUtils</a> has the <em>lazy</em> List type processing. <a href="javascript:;" class="external-link" rel="nofollow">LazyValidatorForm</a> is built using the <a class="unresolved" href="#">BeanUtils</a> <a class="unresolved" href="#">LazyDynaBean</a> and can be used by simply configuring it through the struts-config.xml.</p>


<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>
  &lt;form-beans&gt;

     &lt;form-bean name=&quot;skillForm&quot; type=&quot;org.apache.struts.validator.LazyValidatorForm&gt;
        &lt;form-property name=&quot;skills&quot; type=&quot;java.util.ArrayList&quot;/&gt;
     &lt;/form-bean&gt;

  &lt;/form-beans&gt; 

</pre>
</div></div>

<p>In fact using Arrays (rather than Lists) a <a class="unresolved" href="#">LazyDynaBean</a> can be used directly, in the following way:</p>

<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>
  &lt;form-beans&gt;

     &lt;form-bean name=&quot;skillForm&quot; type=&quot;org.apache.commons.beanutils.LazyDynaBean&quot;&gt;
        &lt;form-property name=&quot;skills&quot; type=&quot;myPackage.SkillBean[]&quot;/&gt;
     &lt;/form-bean&gt;

  &lt;/form-beans&gt; 

</pre>
</div></div>

<p>Struts 1.2.4 will <em>wrap</em> the <a class="unresolved" href="#">LazyDynaBean</a> in a <a class="unresolved" href="#">BeanValidatorForm</a> automatically.</p>


<h3 id="StrutsCatalogLazyList-UsingtheDecoratorPatternUnderlyingLazyListwithInstrumentedForms:OneAlternativeSuggestedSomeTimeAgo">Using the Decorator Pattern Underlying LazyList with Instrumented Forms : One Alternative Suggested Some Time Ago</h3>

<p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p><p class="conf-macro output-block" data-hasbody="true" data-macro-name="unmigrated-wiki-markup">Rather than use collections classes that are decorated in forms, why not make the forms themselves instrumentable by having them decorate the collections?  I suggested this sometime ago on this wiki, but the idea could not be implemented until the processing for forms with the collections classes caught up with the idea, distinguishing between a mere Map, for example, and an <a href="actionform.html" title="ActionForm">ActionForm</a> that was also a decorated Map.  I called these Instrumented Forms and used the recommendations of Joshua Bloch to code them.  [&quot;http://www.michaelmcgrady.com&quot; – see the coding ideas section and then instrumented forms]</p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p>


<p>Michael McGrady</p>

<h3 id="StrutsCatalogLazyList-Gotchas"><a class="unresolved" href="#">LazyDynaBean</a> Gotchas</h3>
<p>The above solution using <a class="unresolved" href="#">LazyDynaBean</a> looks like a simple drop in replacement which is great, however it assumes that the Struts Validator is active. If you are not familiar with the validator (I wasn't when I got directed to this page for a solution) then it can cost you a number of hours of head scratching and frustration whilst you figure it out. To summarise and hopefully give someone a kick start to this, you need to:</p>

<ol>
	<li>Include the Commons Validator jar in your project.
<br class="atl-forced-newline"></li>
</ol>


<p>2. Modify your struts-config.xml to include the validator plugin.</p>

<p>3. Copy the the validator-rules.xml file from the struts download or source one from somewhere else.</p>

<p>4. Create and amend the valilation.xml file to include a section for each of your forms you wish to use <a class="unresolved" href="#">LazyDynaBeans</a> for.</p>

<p>I found the struts doco assumed you already know how all of this worked so wasn't much help to getting started. The best place to find help is in referenced resources down the bottom of <a href="javascript:;" class="external-link" rel="nofollow">http://struts.apache.org/userGuide/dev_validator.html</a></p>

<p>Derek Clarkson</p>

<h3 id="StrutsCatalogLazyList-Extendingthestruts">Extending the struts <a class="unresolved" href="#">DynaActionForm</a></h3>
<p>I came up with this code after looking around and not really being satified with any of the solutions I found. They either required a lot of fiddling and setup in the application, or involved install all sorts of packages I didn't really want to use. Basically I don't like making things any more complex than they should be. So I came up with this class which extends the struts <a class="unresolved" href="#">DynaActionForm</a> to effective lazy load lists and arrays without requiring any additional software or setup over the standard <a class="unresolved" href="#">DynaActionForm</a>.</p>

<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>package com.dhc.form;

import org.apache.struts.action.DynaActionForm;

import java.lang.reflect.Array;
import java.util.List;

/**
 * This class extends
 * {@link org.apache.struts.action.DynaActionForm DynaActionForm} so that we can
 * fix the issues where array references in the properties are not created and
 * cause index exceptions to be thrown. The intent is to re-code the set method
 * so that when an index value is being set, the arrays are extended as
 * necessary by an automatic process. This should remove the necessity for using
 * one of a number of messy work-arounds being used by the struts community.
 * &lt;p&gt;
 * &lt;b&gt;NOTE&lt;/b&gt; after submitting this for comment on java ranch I found out about a
 * similar thing using the Bean utils lazy forms. However when I tried to implement
 * it, I ran into all sorts of problems with implementing. Most notibly they are 
 * heavily linked to the use of the Validator which menas you must register all forms
 * with it before you can use the lazy forms. It took me some time to work this out
 * because the error messages that are generated are very vague about what the issue is 
 * which makes it difficult to sort out.
 * &lt;p&gt;
 * I also looked at using the commons collection LazyList to drive it. but the issue 
 * with that is that it requires the class to provide a factory for generating
 * objects to be stored. This is ok when you know what you are storing but the idea
 * behind a dynaactionform is that you do not.
 * &lt;p&gt;
 * To cut a long story short this code is smaller, requires no implementation, xml files
 * supporting it or other libraries.
 * 
 * 
 * @author Derek Clarkson
 */
public class LazyDynaActionForm extends DynaActionForm {

   // @Override
   public void set(String name, int index, Object value) {

      // get the array container from the hashmap of properties. This should
      // return an array object or a list.
      Object prop = this.dynaValues.get(name);
      Class arrayClass = prop.getClass();

      // error trap.
      if (prop == null) {
         throw new NullPointerException(&quot;No indexed value for '&quot; + name + &quot;[&quot; + index + &quot;]'&quot;);
      }

      if (arrayClass.isArray()) {

         // First check that the array is big enough. If not then we need to
         // expand it and store the expanded one.
         if (Array.getLength(prop) &lt; index + 1) {
            Object newArray = Array.newInstance(arrayClass.getComponentType(), index + 1);
            System.arraycopy(prop, 0, newArray, 0, Array.getLength(prop));
            this.dynaValues.put(name, newArray);
            prop = newArray;
         }

         // Now store the value.
         Array.set(prop, index, value);

      } else if (prop instanceof List) {

         // Quick local ref for ease of coding.
         List list = (List) prop;

         // Now check the length and expand as necessary.
         if (list.size() &lt; index + 1) {

            // I could not see any way of doing this other than this. Basically
            // because my criteria was
            // that I did not want to replace the list, only expand it because
            // then I would not have to deal
            // with issues of getting the correct type, etc. Alternatives welcome.
            for (int i = list.size(); i &lt;= index; i++) {
               list.add(null);
            }
         }

         // Store the new value.
         list.set(index, value);

      } else {
         throw new IllegalArgumentException(&quot;Non-indexed property for '&quot; + name + &quot;[&quot; + index + &quot;]'&quot;);
      }

   }
}

</pre>
</div></div>

<p>Enjoy, Derek Clarkson</p>

<p>Problem - How do we deal with Lists of objects that contain Lists?</p>

<p>I'm still stumped with the best way to handle cases where your nesting goes a bit deeper than the examples shown here. For example lets assume you want to edit on a single form a list of Employees - where you want to be able to edit their name AND a List of phone numbers:</p>

<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>Employee              Phone Numbers
--------              -------------
John Doe              888-888-8888
                      888-111-1111
                      222-222-2222
Bill Boo              111-111-3333
                      444-333-3333

</pre>
</div></div>
<p>So we might have basically a List of Employee objects where Employee has:</p>
<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>Employee:   
   String name;
   List phoneNumbers;

Our form bean can have:

ActionForm:
   List employees;
</pre>
</div></div>

<p>Here's the problem.... in the reset method you can set a <a href="lazylist.html">LazyList</a> to wrap the Employees but there is still the problem of the internal List of phoneNumbers in each Employee.</p>

<p>I was trying:</p>
<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>public void reset(ActionMapping actionMapping, HttpServletRequest httpServletRequest) {

    employees = ListUtils.lazyList(new java.util.ArrayList(), new Factory() {
        public Object create() {
            return buildEmployee();
        }
    });
 }

private Employee buildEmployee() {
    //This really isn't working, I'll still get index out of bounds, when 
    //trying to set an index of the phoneNumbers list
    Employee emp = new Employee();
    List phoneNumbers = ListUtils.lazyList(new java.util.ArrayList(), new Factory() {
        public Object create() {
            return new String();
        }
    });
    emp.setPhoneNumbers( phoneNumbers );
    return emp;
     
}
</pre>
</div></div>
<p>Of course all of these problems go away if I just use the Session to store the form, but I really want to figure out a nice way to get this to work using the Request. Feel free to delete this once a nice solution is proposed. </p>

<p><strong>Somewhat of a solution:</strong></p>

<p>The problem above is that I was using a List of Strings (phoneNumbers) as the property in my Employee  object. Everything ends up working fine if instead I create a List of &quot;Contact&quot; objects (where each Contact object has a &quot;phoneNumber&quot; - and I also added a &quot;label&quot;):</p>


<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>Employee:   
   String name;
   List contacts;

Contact:
   String label;
   String phoneNumber;

Form bean still with:

ActionForm:
   List employees;
</pre>
</div></div>

<p>The reset was then modified to:</p>

<div class="preformatted panel conf-macro output-block" style="border-width: 1px;" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>public void reset(ActionMapping actionMapping, HttpServletRequest httpServletRequest) {

    employees = ListUtils.lazyList(new java.util.ArrayList(), new Factory() {
        public Object create() {
            return buildEmployee();
        }
    });
 }

private Employee buildEmployee() {
    Employee emp = new Employee();
    List contacts = ListUtils.lazyList(new java.util.ArrayList(), new Factory() {
        public Object create() {
            return new Contact();
        }
    });
    emp.setContacts( contacts );
    return emp;
}
</pre>
</div></div>


<h3 id="StrutsCatalogLazyList-Stillnotverysatisified">Still not very satisified</h3>
<p>I'm still not happy with the solutions provided (including my own). Many of the above solutions assume you know how deep your items are nested, or that you create nested objects up front that can handle the lazy situation. Where I'm not happy is where you can get back a nested structure of unknown depth. I have a case now where the generated content that can be editable is a questionnaire and each question can end up having sub-questions. Other than using Session scope I'm not sure of the best approach to use. I'm messing around with <a class="unresolved" href="#">LazyDynaMaps</a> to see if that might work. Not the ideal solution since I'd prefer to use straight value objects from the midtier, but I'll compromise if need be.</p>

<p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p><p class="conf-macro output-block" data-hasbody="true" data-macro-name="unmigrated-wiki-markup">    <em><span class="nobr"><a href="javascript:;" class="external-link" rel="nofollow">NestedLazyBean<sup><img class="rendericon" src="static/picture/linkext7.gif" height="7" width="7" align="absmiddle" alt="" border="0"></sup></a></span> does n level indexed properties. For straight forward object graphs (e.g. <code>person.address.line1</code>) where you want an &quot;address&quot; DynaBean automatically created when <code>person.get(&quot;address&quot;).set(&quot;line1&quot;, ...)</code> is called then its slightly more problematic, since how do you know when it hits <code>get(&quot;address&quot;)</code> that it should be a DynaBean property rather than some other regular kind? Using BeanUtils's <strong>Map</strong> notation (i.e. using <code>person[address][line1]</code>) works from a LazyDynaMap PoV, but you will need the <span class="nobr"><a href="javascript:;" class="external-link" rel="nofollow">BeanUtils 1.8.0-BETA<sup><img class="rendericon" src="static/picture/linkext7.gif" height="7" width="7" align="absmiddle" alt="" border="0"></sup></a></span>, since nested maps were not supported until that version.</em></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p>

                
        
    
        </div>

                        
    



<div id="labels-section" class="pageSection group">
    <div class="labels-section-content content-column" entityid="120724385" entitytype="page">
	<div class="labels-content">
		
    <ul class="label-list label-list-right ">
            <li class="no-labels-message">
            无标签
        </li>
            </ul>

    </div>
</div>
</div>
        
		
            




            
        








                        
    
<div id="comments-section" class="pageSection group">
        
    



</div>
        


                
    
            
</div>

    

    




    
    

    
    
    


    
<div id="space-tools-web-items" class="hidden">
                <div data-label="概览" data-href="/confluence/spaces/viewspacesummary.action?key=WW">概览</div>
            <div data-label="内容工具" data-href="/confluence/pages/reorderpages.action?key=WW">内容工具</div>
            <div data-label="应用" data-href="/confluence/spaces/snippeterrors.action?key=WW">应用</div>
    </div>
        



            </div><!-- \#main -->
            
    
    
        
            
            

<div id="footer" role="contentinfo">
    <section class="footer-body">

                                                            <p class="license license-opensource">
                    本站点免费授予 Apache Software Foundation<b> Atlassian Confluence 开源项目授权</b>。<a href="javascript:;">今天开始评估 Confluence</a>。<br>
                </p>
                    
        

        <ul id="poweredby">
            <li class="noprint">基于 <a href="javascript:;" class="hover-footer-link" rel="nofollow">Atlassian Confluence</a> <span id='footer-build-information'>7.5.0</span> 技术构建</li>
            <li class="print-only">由 Atlassian 合流7.5.0 打印</li>
            <li class="noprint"><a href="javascript:;" class="hover-footer-link" rel="nofollow">报告缺陷</a></li>
            <li class="noprint"><a href="javascript:;" class="hover-footer-link" rel="nofollow">Atlassian 新闻</a></li>
        </ul>

        

        <div id="footer-logo"><a href="javascript:;" rel="nofollow">Atlassian</a></div>

                    
        
    </section>
</div>

    
</div>

</div><!-- \#full-height-container -->
</div><!-- \#page -->

    <span style="display:none;" id="confluence-server-performance">{"serverDuration": 189, "requestCorrelationId": "d409735da79bdd7e"}</span>
</body>
</html>
    
